<div
  class="doc-page ehla-blue-bg material-docs layout-docs doc-template page-layout simple tabbed ng-scope layout-column"
  layout="column">

  <div ncy-breadcrumb></div>

  <!-- HEADER -->
  <div class="header md-accent-bg" layout="row" layout-align="start center">
    <div class="white-fg" layout="row" layout-align="start center" flex>
      <div layout="row" layout-align="start center">
        <div layout="column" layout-align="start start">
          <div class="h2">
            {{vm.detail.name_en}}
          </div>
        </div>
      </div>
    </div>

    <div>
      <md-button ng-if="breadcrumbs.assignStatus === 'unassigned'" class="md-raised md-accent md-background"
                 ng-click="createAssignment()" ng-disabled="loading">
        <span>Publish</span>
      </md-button>
      <md-button ng-if="breadcrumbs.assignStatus === 'assigned'" class="md-raised md-warn md-background"
                 ng-click="createAssignment()" ng-disabled="loading">
        <span>Delete</span>
      </md-button>
      <md-button class="md-raised md-background" ng-click="vm.back()">
        <span>Back</span>
      </md-button>
    </div>
  </div>
  <!-- / HEADER -->

  <div class="content exercise-content">

    <md-tabs md-dynamic-height>

      <md-tab label="Basic Info" md-on-select="vm.switchSection('info')">
        <md-tab-body>
          <div class="exercise-detail-form-container md-background-bg md-whiteframe-1dp">
            <form class="md-inline-form">
              <md-input-container class="md-block">
                <label>Level</label>
                <input ng-model="vm.detail.level_desc_en" readonly>
              </md-input-container>

              <md-input-container class="md-block">
                <label>Difficulty</label>
                <input ng-model="vm.detail.difficulty_en" readonly>
              </md-input-container>


              <md-input-container class="md-block" ng-if="vm.detail.theme_chosen">
                <label>Theme</label>
                <input ng-model="vm.detail.theme_chosen" readonly>
              </md-input-container>

              <md-input-container class="md-block" ng-if="vm.detail.article_ori">
                <label>Article</label>
                <textarea ng-model="vm.detail.article_ori" readonly rows="3"></textarea>
              </md-input-container>
            </form>

          </div>
        </md-tab-body>
      </md-tab>

      <md-tab label="Preview" md-on-select="vm.switchSection('preview')">
        <md-tab-body>
          <div id="preview-dialog" class="exercise-detail-form-container md-background-bg md-whiteframe-1dp"
               ng-bind-html="vm.trustSrc(vm.detail['preview_en'])">
          </div>
        </md-tab-body>
      </md-tab>

      <md-tab label="Exercise" md-on-select="vm.switchSection('exercise')">
        <md-tab-body>
          <div class="exercise-detail-form-container md-background-bg md-whiteframe-1dp">
            <div>
              <ul class="ehla-table-list ehla-table-list-header">
                <li style="width: 40%">
                  <span>Name</span>
                </li>
                <li style="width: 20%">
                  Starting Time
                </li>
                <li style="width: 20%">
                  End Time
                </li>
                <li style="width: 20%;">
                  Remark
                </li>
              </ul>
            </div>
            <div ui-tree="treeOptionsAssigned"
                 ui-tree-nodes
                 data-drag-enabled="false"
                 ng-model="vm.data">
              <div ng-repeat="node in vm.data"
                   ui-tree-node
                   ng-hide="!node._visible_"
                   ng-include="'nodes_exercise'">
              </div>
            </div>
            <script type="text/ng-template" id="nodes_exercise">
              <ul class="ehla-table-list" ui-tree-handle ng-class="[node._index_ % 2 === 0 ? 'ehla-table-list-even' : 'ehla-table-list-odd']">
                <li style="width: 40%">
                  <div ng-style="{'margin-left': 20*(depth()-1) + 'px'}" style="padding: 0 5px;">
                    <table>
                      <tr>
                        <td>
                          <md-checkbox ng-checked="node.checkStatus==='checked'"
                                       md-indeterminate="node.checkStatus==='partlyChecked'"
                                       ng-click="toggleCheck(node)">
                          </md-checkbox>
                        </td>
                        <td>
                          <a class="btn btn-xs" ng-if="node.child && node.child.length > 0"
                             data-nodrag
                             ng-click="toggleExpand(node)">
                                      <span class="icon s20" ng-class="{
                                          'icon-plus': !expanded[node.id],
                                          'icon-minus': expanded[node.id]
                                          }">
                                      </span>
                          </a>
                        </td>
                        <td>
                          <a class="btn btn-xs ng-scope" style="visibility: hidden"
                             ng-if="!node.child || !node.child.length">
                                            <span class="icon icon-plus">
                                      </span></a>
                        </td>
                        <td>
                          <span>{{ node.name || node.name }}</span>
                        </td>
                      </tr>
                    </table>
                  </div>
                </li>
                <li style="width: 20%">
                  <md-input-container class="md-block" flex-gt-sm ng-if="!node.child || node.child.length === 0">

                    <input mdc-datetime-picker="" date="true" time="true" type="text" id="astarttime"
                           style="max-width: 90%;" title="{{node.start_date | date : 'yyyy-MM-dd HH-mm'}}"
                           show-todays-date="" min-date="date"
                           ng-model="node.start_date" class="md-input" required="true"
                           readonly="readonly">
                  </md-input-container>
                </li>
                <li style="width: 20%">
                  <md-input-container class="md-block" flex-gt-sm ng-if="!node.child || node.child.length === 0">

                    <input mdc-datetime-picker="" date="true" time="true" type="text" id="aendtime"
                           style="max-width: 90%;" title="{{node.end_date | date : 'yyyy-MM-dd HH-mm'}}"
                           show-todays-date="" min-date="date"
                           ng-model="node.end_date" class="md-input" required="true"
                           readonly="readonly">
                  </md-input-container>
                </li>
                <li style="width: 20%">
                  <md-input-container style="width: 100%;" ng-if="!node.child || node.child.length === 0">
                    <input type="text" ng-model="node.remark" style="width: 90%;">
                  </md-input-container>
                </li>
              </ul>
              <div
                ng-if="node.child && node.child.length > 0 && expanded.hasOwnProperty(node.id)"
                ng-show="expanded[node.id]"
                ui-tree-nodes=""
                ng-model="node.child"
                style="background: white; "
              >
                <div ng-repeat="node in node.child"
                     ui-tree-node
                     ng-hide="!node._visible_"
                     ng-include="'nodes_exercise'"></div>
              </div>

            </script>
          </div>
        </md-tab-body>
      </md-tab>

      <md-tab label="Extended Learning" md-on-select="vm.switchSection('extended')">
        <md-tab-body>
          <div class="exercise-detail-form-container md-background-bg md-whiteframe-1dp">

            <div>
              <ul class="ehla-table-list ehla-table-list-header">
                <li style="width: 30%">
                  <span>Video</span>
                </li>
                <li style="width: 10%;">Starting Time</li>
                <li style="width: 10%;">End Time</li>
                <li style="width: 10%;">School Tailored Level</li>
                <li style="width: 10%;">Language</li>
                <li style="width: 10%;">Remark</li>
                <li style="width: 10%;text-align: center;">Tutor</li>
                <li style="width: 10%;text-align: center;">
                  Preview
                </li>
              </ul>
            </div>
            <ul class="ehla-table-list" ng-repeat="v in vm.extendedLearning[0].detail" style="border-bottom: none; padding: 0"
                ng-class="[$index % 2 === 0 ? 'ehla-table-list-even' : 'ehla-table-list-odd']">
              <ul class="ehla-table-list" style="padding: 0">
                <li style="width: 30%">
                  <md-checkbox ng-value="v.name_en || v.name_zh" ng-model="vm.node.selectedVideos[v.id]" class="no-margin">
                    <span>{{v.name_en || v.name_zh}}</span>
                  </md-checkbox>
                </li>
                <li style="width: 10%;">
                  <md-input-container class="md-block" flex-gt-sm>

                    <input mdc-datetime-picker="" date="true" time="true" type="text" id="starttime"
                           style="max-width: 90%;"
                           title="{{node.start_date | date : 'yyyy-MM-dd HH-mm'}}"
                           show-todays-date="" min-date="date"
                           ng-model="node.start_date" class="md-input" required="true"
                           readonly="readonly">
                  </md-input-container>
                </li>
                <li style="width: 10%;">
                  <md-input-container class="md-block" flex-gt-sm>

                    <input mdc-datetime-picker="" date="true" time="true" type="text" id="endtime"
                           style="max-width: 90%;"
                           title="{{node.end_date | date : 'yyyy-MM-dd HH-mm'}}"
                           show-todays-date="" min-date="date"
                           ng-model="node.end_date" class="md-input" required="true"
                           readonly="readonly">
                  </md-input-container>
                </li>
                <li style="width: 10%">
                  P1
                </li>
                <li style="width: 10%">
                  {{vm.displayLanguage(v.teaching_lang_type)}}
                </li>
                <li style="width: 10%">
                  {{v.remark || 'This is remark'}}
                </li>
                <li style="width: 10%; text-align: center; position: relative" ng-style="{'background-color': v.isShowTutor ? 'background-color: rgb(2,136,209);' : 'auto'}">
                  <div ng-if="v.tutor.name_en || v.tutor.name_zh">
                    <a style="cursor: pointer" ng-click="vm.showTutor(v)" ng-style="{'color': v.isShowTutor ? 'white' : 'auto'}">
                      <span>Tutors</span>
                      <!--
                      <md-icon md-font-icon="icon-chevron-up" ng-if="!v.isShowTutor"
                               class="icon s12 md-default-theme md-font material-icons"
                               aria-hidden="true"></md-icon>
                      <md-icon md-font-icon="icon-chevron-down" ng-if="v.isShowTutor"
                               class="icon s12 md-default-theme md-font material-icons"
                               aria-hidden="true"></md-icon>
                               -->
                    </a>
                  </div>
                  <div ng-if="!v.tutor.name_en && v.tutor.name_zh">
                    -
                  </div>
                </li>
                <li style="width: 10%; text-align: center;" ng-style="{'background-color': v.isPreview ? 'background-color: rgb(2,136,209);' : 'auto'}">
                  <a style="cursor: pointer" ng-click="vm.preview(v)" ng-style="{'color': v.isPreview ? 'white' : 'auto'}">
                    <span>Preview</span>
                    <!--
                    <md-icon md-font-icon="icon-chevron-up" ng-if="!v.isPreview"
                             class="icon s12 md-default-theme md-font material-icons"
                             aria-hidden="true"></md-icon>
                    <md-icon md-font-icon="icon-chevron-down" ng-if="v.isPreview"
                             class="icon s12 md-default-theme md-font material-icons"
                             aria-hidden="true"></md-icon>
                             -->
                  </a>
                </li>
              </ul>
              <ul class="ehla-table-list info-section" style="padding: 0" ng-show="v.isShowTutor">
                <li style="width: 100%; position: relative" ng-repeat="tutor in v.tutors">
                  <div layout="row" style="padding: 10px 0;">
                    <div><img class="tutor-pic" ng-src="{{tutor.profile_pic_path}}" style="height: 200px;"></div>
                    <div flex class="tutor-desc">
                      <h2 style="text-align: center">
                        {{tutor.name_en || tutor.name_zh}}
                      </h2>
                      <h3 ng-if="tutor.title_en || tutor.title_zh">
                        test
                        {{tutor.title_en || tutor.title_zh}}
                      </h3>
                      <div style="padding: 0 30px">
                        {{tutor.short_description_en || tutor.short_description_zh}}
                      </div>
                    </div>
                  </div>
                </li>
              </ul>
              <ul class="ehla-table-list info-section" style="padding: 0" ng-show="v.isPreview">
                <li style="width: 100%; position: relative">
                  <div id="video{{v.id}}" style="width: 100%; padding: 10px"></div>
                </li>
              </ul>
            </ul>
          </div>
        </md-tab-body>
      </md-tab>

    </md-tabs>

  </div>

</div>
</div>
